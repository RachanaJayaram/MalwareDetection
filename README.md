# MalwareDetection

**Feature Engineering and Dimensionality Reduction**

Feature engineering is done by feature.py

Additonally, notebook called "Malware Detection by Exploratory Territory.ipynb" provides data visualization along with contents of feature.py to back the feature choice and dropping.<br/>

To view the notebook on github use nbviewer as it gives proper rendering of plotly plots.<br/>

Alternatively, it is also hosted as private kernel at https://www.kaggle.com/mehulthakral/malware-detection-by-exploratory-territory <br/>

Steps to run :<br/>

1) Install all requirements numpy,matplotlib,pandas and seaborn (all are there in kaggle)
2) Additionally install chart_studio (from kaggle console in case of kaggle) for ploting plots using plotly.  
3) Change the path of the train.csv in "Loading the data" part use /kaggle/input/microsoft-malware-prediction/train.csv as path if using it in kaggle
4) Change path of the destination where the new_train.csv must be stored
<br/>
The new csv will have all the unwanted features removed.


Models Tried

1. LSTM : LSTM was tried. It is available in LSTM.py. The AUC was 0.55 approx
2. LSTM-CNN : Available in LSTM_CNN.py. results similar to LSTM were obtained
3. LightGBM : Testing

Observation : 

NeuralNets are not appropriate

<hr>

<h5> Time Series </h5>
This kind of malware risk detection is in essence a time series problem, with the sampling date of each data point greatly influencing the some of the system’s properties. The given dataset is also split into test and train in such a way that a majority of entries in the train data are from August and September 2018 while the training data is mostly
from October and November 2018.(As seen in LGBM_EDA.ipynb)
<br>
But the problems posed to the traditional time series approach by this dataset are the following:
<br>
• New systems are added to the dataset with time.
<br>
• There are systems that occasionally go offline for variable durations of time. No data from these systems are recorded in this period.
<br>
• Systems receive OS patches, bug fixes and OS upgrades over time thereby changing their properties. 
<br>
This analysis is intuitive as newer versions of operating systems and antivirus software to combat ever-improving malware.

<hr>

<h5> Light Gradient Boosting Machine </h5>
 <br>
The solution, that best suits the given dataset, is to build a Gradient Boosting Machine using the LGBM framework to predict the probability of a machine being hit by a malware soon. The model is further enhanced to better represent the underlying time series aspect of the problem by handcrafting new features, as a part of feature engineering (Attribute "WeekNo" as seen in LGBM_EDA.ipynb amd LGBM_model1.py).

